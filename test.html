<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./globe.css">
    <title>Marshal</title>
    <!-- importmap 정의 -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.166.1/build/three.module.js",
                "OrbitControls":"https://cdn.jsdelivr.net/npm/three@0.166.1/examples/jsm/controls/OrbitControls.min.js",
                "three-globe":"https://cdn.jsdelivr.net/npm/three-globe@2.31.1/+esm",
                "trackControl":"https://cdn.jsdelivr.net/npm/three@0.166.1/examples/jsm/controls/TrackballControls.js",
                "tween":"https://cdn.jsdelivr.net/npm/@tweenjs/tween.js@23.1.2/+esm"
            }
        }
    </script>
</head>

<body>
    <div id="globe"></div>
    <div id="modal">
        <div class="modal_wrapper">
            <header id="about">
                <div class="profile">
                    <ul>
                        <li class="image">
                            <img src="" alt="">
                        </li>
                        <li class="name">
                            <p>조성은</p>
                        </li>
                        <li class="sign(나의 한줄 소개)"></li>
                    </ul>
                </div>
                <div class="chator">
                    <ul>
                        <li class="college"></li>
                        <li class="goals"></li>
                        <li class="learningCurv"></li>
                        <li class=""></li>
                    </ul>
                </div>
                <div class="projects">
                    <ul>
                        <li class="">
                            정부지원사업
                        </li>
                        <li class="">
                            r&d
                        </li>
                    </ul>
                </div>
                <div class="link">
                    <ul class="social media">
                        <li class="github"></li>
                        <li class="naver"></li>
                        <li class="google"></li>
                    </ul>
                </div>
            </header>
            <article class="slideMenu">
                <section>
                    <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Id dolores quasi laborum, laboriosam
                        fugit
                        voluptate tenetur velit? At illum, iste amet ipsam architecto, tempore porro nihil quidem cum ea
                        ex?
                        Veritatis praesentium quam nulla consequuntur ducimus iure excepturi nisi voluptates
                        reprehenderit
                        hic! Laudantium dolores aut voluptas reiciendis consequuntur reprehenderit, corrupti velit,
                        omnis
                        doloribus hic modi id vitae nemo ab alias!
                        Error natus alias fuga neque explicabo quod sequi, saepe eum, distinctio ratione, nisi numquam!
                        Fuga
                        atque, accusantium inventore ad dicta illum expedita delectus excepturi consectetur ratione
                        minima
                        saepe perferendis molestias?
                        Neque quia nam distinctio, nihil corrupti, iusto quidem aut vel pariatur ad deserunt? Accusamus,
                        necessitatibus placeat corrupti aperiam itaque ab sunt minus, quas quisquam, hic delectus?
                        Temporibus similique sed error.
                        Temporibus deserunt incidunt dolor cupiditate mollitia labore dignissimos eius asperiores sint
                        beatae error inventore, numquam quisquam nobis officia omnis quas eveniet? Et iste consequuntur
                        aliquid deserunt esse officiis fugit ab.
                        Numquam incidunt nemo iste. Possimus fugit, delectus tempore quasi, corrupti unde quod vel ipsa
                        officia, earum molestiae rem fuga provident perferendis aspernatur eaque quibusdam? Voluptas
                        perspiciatis at debitis reiciendis recusandae?
                        Temporibus, quae! Numquam dolores quam fuga magni, eligendi neque exercitationem repellendus
                        totam,
                        delectus provident est molestias corporis in odit, voluptatem distinctio officia mollitia
                        possimus
                        ipsum dolorem quidem nostrum? Quibusdam, velit.
                        Iusto quaerat id cumque esse, at vel maxime! Labore facilis quis vero ut ad? Qui maiores, maxime
                        unde corrupti, deleniti, tempora iusto cum reprehenderit similique in neque fuga suscipit sequi?
                        Omnis natus accusamus optio dicta maxime odio minima, provident sapiente perspiciatis magnam nam
                        iste id ducimus debitis explicabo. Nostrum reprehenderit quisquam dolorem assumenda magni neque
                        eaque maiores nobis aut! Tenetur.
                        Exercitationem quos veritatis delectus eligendi fugiat alias placeat perferendis consequuntur
                        dolorum id, nostrum nemo praesentium reiciendis enim illum eos sunt vitae mollitia maiores optio
                        cumque minima minus? Voluptate, neque tenetur.</p>
                </section>
                <section>
                    <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Id dolores quasi laborum, laboriosam
                        fugit
                        voluptate tenetur velit? At illum, iste amet ipsam architecto, tempore porro nihil quidem cum ea
                        ex?
                        Veritatis praesentium quam nulla consequuntur ducimus iure excepturi nisi voluptates
                        reprehenderit
                        hic! Laudantium dolores aut voluptas reiciendis consequuntur reprehenderit, corrupti velit,
                        omnis
                        doloribus hic modi id vitae nemo ab alias!
                        Error natus alias fuga neque explicabo quod sequi, saepe eum, distinctio ratione, nisi numquam!
                        Fuga
                        atque, accusantium inventore ad dicta illum expedita delectus excepturi consectetur ratione
                        minima
                        saepe perferendis molestias?
                        Neque quia nam distinctio, nihil corrupti, iusto quidem aut vel pariatur ad deserunt? Accusamus,
                        necessitatibus placeat corrupti aperiam itaque ab sunt minus, quas quisquam, hic delectus?
                        Temporibus similique sed error.
                        Temporibus deserunt incidunt dolor cupiditate mollitia labore dignissimos eius asperiores sint
                        beatae error inventore, numquam quisquam nobis officia omnis quas eveniet? Et iste consequuntur
                        aliquid deserunt esse officiis fugit ab.
                        Numquam incidunt nemo iste. Possimus fugit, delectus tempore quasi, corrupti unde quod vel ipsa
                        officia, earum molestiae rem fuga provident perferendis aspernatur eaque quibusdam? Voluptas
                        perspiciatis at debitis reiciendis recusandae?
                        Temporibus, quae! Numquam dolores quam fuga magni, eligendi neque exercitationem repellendus
                        totam,
                        delectus provident est molestias corporis in odit, voluptatem distinctio officia mollitia
                        possimus
                        ipsum dolorem quidem nostrum? Quibusdam, velit.
                        Iusto quaerat id cumque esse, at vel maxime! Labore facilis quis vero ut ad? Qui maiores, maxime
                        unde corrupti, deleniti, tempora iusto cum reprehenderit similique in neque fuga suscipit sequi?
                        Omnis natus accusamus optio dicta maxime odio minima, provident sapiente perspiciatis magnam nam
                        iste id ducimus debitis explicabo. Nostrum reprehenderit quisquam dolorem assumenda magni neque
                        eaque maiores nobis aut! Tenetur.
                        Exercitationem quos veritatis delectus eligendi fugiat alias placeat perferendis consequuntur
                        dolorum id, nostrum nemo praesentium reiciendis enim illum eos sunt vitae mollitia maiores optio
                        cumque minima minus? Voluptate, neque tenetur.</p>
                </section>
                <section>
                    <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Id dolores quasi laborum, laboriosam
                        fugit
                        voluptate tenetur velit? At illum, iste amet ipsam architecto, tempore porro nihil quidem cum ea
                        ex?
                        Veritatis praesentium quam nulla consequuntur ducimus iure excepturi nisi voluptates
                        reprehenderit
                        hic! Laudantium dolores aut voluptas reiciendis consequuntur reprehenderit, corrupti velit,
                        omnis
                        doloribus hic modi id vitae nemo ab alias!
                        Error natus alias fuga neque explicabo quod sequi, saepe eum, distinctio ratione, nisi numquam!
                        Fuga
                        atque, accusantium inventore ad dicta illum expedita delectus excepturi consectetur ratione
                        minima
                        saepe perferendis molestias?
                        Neque quia nam distinctio, nihil corrupti, iusto quidem aut vel pariatur ad deserunt? Accusamus,
                        necessitatibus placeat corrupti aperiam itaque ab sunt minus, quas quisquam, hic delectus?
                        Temporibus similique sed error.
                        Temporibus deserunt incidunt dolor cupiditate mollitia labore dignissimos eius asperiores sint
                        beatae error inventore, numquam quisquam nobis officia omnis quas eveniet? Et iste consequuntur
                        aliquid deserunt esse officiis fugit ab.
                        Numquam incidunt nemo iste. Possimus fugit, delectus tempore quasi, corrupti unde quod vel ipsa
                        officia, earum molestiae rem fuga provident perferendis aspernatur eaque quibusdam? Voluptas
                        perspiciatis at debitis reiciendis recusandae?
                        Temporibus, quae! Numquam dolores quam fuga magni, eligendi neque exercitationem repellendus
                        totam,
                        delectus provident est molestias corporis in odit, voluptatem distinctio officia mollitia
                        possimus
                        ipsum dolorem quidem nostrum? Quibusdam, velit.
                        Iusto quaerat id cumque esse, at vel maxime! Labore facilis quis vero ut ad? Qui maiores, maxime
                        unde corrupti, deleniti, tempora iusto cum reprehenderit similique in neque fuga suscipit sequi?
                        Omnis natus accusamus optio dicta maxime odio minima, provident sapiente perspiciatis magnam nam
                        iste id ducimus debitis explicabo. Nostrum reprehenderit quisquam dolorem assumenda magni neque
                        eaque maiores nobis aut! Tenetur.
                        Exercitationem quos veritatis delectus eligendi fugiat alias placeat perferendis consequuntur
                        dolorum id, nostrum nemo praesentium reiciendis enim illum eos sunt vitae mollitia maiores optio
                        cumque minima minus? Voluptate, neque tenetur.</p>
                </section>
            </article>
            <div class="clear-fix"></div>
        </div>
    </div>
    <script type="module">

        import * as THREE from 'three';
        import { OrbitControls } from 'OrbitControls';
        import ThreeGlobe from "three-globe";
        import TWEEN from 'tween';


        // render dom
        const globeContainer = document.getElementById("globe");
        const transitionData = new Map();

        // renderer, camera, scene, controls
        const SCREEN_WIDTH = window.innerWidth;
        const SCREEN_HEIGHT = window.innerHeight;
        const ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT;

        // image URL
        const mapURL = "./static/images/globe/globe_map.jpg";
        const normalURL = "./static/images/globe/earth_normal_2048.jpg";
        const bumpURL = "./static/images/globe/earth_bump.jpg";
        const spechURL = "./static/images/globe/earth_spec.jpg";
        // const metalURL = "./static/images/globe/earth_spec.jpg"
        const emissiveURL = "./static/images/globe/earth_night.jpg";
        const cloudURL = "./static/images/globe/clouds.png";
        const CLOUDS_ALT = 0.008;
        const CLOUDS_ROTATION_SPEED = -0.006; // deg/frame


        const pMaterial = new THREE.MeshPhongMaterial({
            specular: 0x7c7c7c,
            map: imageLoader(mapURL),
            bumpMap: imageLoader(bumpURL),
            specularMap: imageLoader(spechURL),
            normalMap: imageLoader(normalURL),
            normalScale: new THREE.Vector2(0.85, - 0.85),
        });
        pMaterial.map.colorSpace = THREE.SRGBColorSpace;
        // object
        const planet = new ThreeGlobe();

        const pCloud = new THREE.Mesh(
            new THREE.SphereGeometry(planet.getGlobeRadius() * (1 + CLOUDS_ALT), 75, 75),
            new THREE.MeshStandardMaterial({
                map: imageLoader(cloudURL),
                transparent: true,
            })
        )
        // add cloud texture
        pCloud.rotation.y += CLOUDS_ROTATION_SPEED * Math.PI / 180;

        // camera
        const camera = new THREE.PerspectiveCamera();
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        camera.position.z = 500;

        // render
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        globeContainer.appendChild(renderer.domElement);

        // scene
        const scene = new THREE.Scene();
        scene.add(planet);
        scene.add(new THREE.AmbientLight(0xcccccc, Math.PI));
        scene.add(new THREE.DirectionalLight(0xffffff, 0.6 * Math.PI));

        // control
        let controls = new OrbitControls(camera, renderer.domElement);
        // controls.minDistance = 101;
        // controls.rotateSpeed = 5;
        // controls.zoomSpeed = 0.8;
        controls.enableDamping = true;
        controls.dampingFactor = 0.1;
        controls.maxDistance = 600;
        controls.minDistance = 250;
        controls.zoomSpeed = 0.1; // -> linear하게 1까지 변경

        // light -> 초기화
        let light = scene.children.find(light => light.type === "DirectionalLight");
        light.intensity = 3;


        // 


        init();
        function init() {

            planet.showAtmosphere(true)
            planet.atmosphereAltitude(0.3)
            planet.globeMaterial(pMaterial)
            planet.add(pCloud);
            planet.castShadow = true;
            planet.receiveShadow = false;
        }


        function animate() {
            controls.update();
            renderer.render(scene, camera);
            requestAnimationFrame(animate);
            // add cloud texture
            pCloud.rotation.y += CLOUDS_ROTATION_SPEED * Math.PI / 180;
            planet.rotation.y += 0.05 * Math.PI / 180
        }

        function imageLoader(url) {
            return new THREE.TextureLoader().load(url);
        }

        // Tween 애니메이션 함수
        function animateCamera(targetPosition, targetLookAt, duration = 2000) {
            new TWEEN.Tween(camera.position)
                .to(targetPosition, duration)
                .easing(TWEEN.Easing.Quadratic.InOut)
                .onUpdate(() => {
                    camera.lookAt(targetLookAt);
                    controls.update();
                })
                .start();
        }
        // event listener

        function showUpModal() {
            const modal = document.querySelector("#modal");
            modal.classList.add("show");
        }

        controls.addEventListener("change", function (event) {
            // controls.enabled = false;
            console.log("wheel-event: ", event.target);
            // cam
            console.log("camera-world-direction: ", camera.getWorldDirection(new THREE.Vector3()));
            // globe position world coordinates
            console.log("globe-position: ", planet.position);

            // camera position world coordinates
            console.log("camera-position:", camera.position);
            // globe <-> camera: distance,
            console.log("distance with globe:", camera.position.distanceTo(planet.position));

            setInterval(showUpModal(), 1000);

            // phase = (phase + 1) % 4;
            // switch (phase) {
            //     case 0:
            //         animateCamera({ x: 0, y: -10, z: 14 }, planet.position);
            //         break;
            //     case 1:
            //         animateCamera({ x: 0, y: 0, z: 14 }, planet.position);
            //         break;
            //     case 2:
            //         animateCamera({ x: 10, y: 0, z: 14 }, planet.position);
            //         break;
            //     case 3:
            //         animateCamera({ x: 0, y: 0, z: 14 }, planet.position);
            //         break;
            // }
        })

        window.addEventListener('resize', () => {
            const width = window.innerWidth;
            const height = window.innerHeight;
            renderer.setSize(width, height);
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
        });


        animate();
    </script>

    <script type="module">
        // import * as THREE from 'three';
        // import { OrbitControls } from 'OrbitControls';

        // // render dom
        // const planetElement = document.getElementById("globe");
        // const transitionData = new Map();

        // // renderer, camera, scene, controls
        // let camera, scene, renderer;
        // const SCREEN_WIDTH = window.innerWidth;
        // const SCREEN_HEIGHT = window.innerHeight;
        // const ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT;

        // // image URL
        // const mapURL = "./static/images/globe/globe_map.jpg";
        // const normalURL = "./static/images/globe/earth_normal_2048.jpg";
        // const bumpURL = "./static/images/globe/earth_bump.jpg";
        // const spechURL = "./static/images/globe/earth_spec.jpg";
        // // const metalURL = "./static/images/globe/earth_spec.jpg"
        // const emissiveURL = "./static/images/globe/earth_night.jpg";
        // const cloudURL = "./static/images/globe/clouds.png";
        // const CLOUDS_ALT = 0.008;
        // const CLOUDS_ROTATION_SPEED = -0.006; // deg/frame

        // // 1. 렌더링 세팅
        // renderer = new THREE.WebGLRenderer({ antialias: true });
        // renderer.setPixelRatio(window.devicePixelRatio);
        // renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
        // renderer.setAnimationLoop(animate);
        // planetElement.appendChild(renderer.domElement);

        // // 2. 화면 세팅
        // scene = new THREE.Scene();
        // scene.background = new THREE.Color("#EEEDEB");

        // // 3. 카메라 세팅
        // camera = new THREE.PerspectiveCamera(75, ASPECT, 0.1, 1000);
        // // camera.position.z = 200;

        // // 4. 컨트롤 세팅
        // const controls = new OrbitControls(camera, renderer.domElement);
        // controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled
        // controls.dampingFactor = 0.05;
        // controls.screenSpacePanning = false;
        // controls.minDistance = 100;
        // controls.maxDistance = 500;
        // controls.maxPolarAngle = Math.PI / 2;

        // controls.update();

        // // 5. 조명세팅
        // const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        // directionalLight.position.set(5, 3, 5);
        // scene.add(directionalLight);

        // // 6. object creation ..earth and.. etc
        // // planet geometry (radius,width-segment,height-segment) setting
        // const pGeometry = new THREE.SphereGeometry(6731, 100, 50);

        // // planet-material-MeshPongMaterial setting
        // const pMaterial = new THREE.MeshPhongMaterial({
        //     specular: 0x7c7c7c,
        //     map: textureLoader(mapURL),
        //     bumpMap: textureLoader(bumpURL),
        //     specularMap: textureLoader(spechURL),
        //     normalMap: textureLoader(normalURL),
        //     normalScale: new THREE.Vector2(0.85, - 0.85),
        // });
        // pMaterial.map.colorSpace = THREE.SRGBColorSpace;

        // // mesh 생성
        // const earth = new THREE.Mesh(pGeometry, pMaterial);
        // earth.position.x = Math.random() * 1600 - 800;
        // earth.position.y = 0;
        // earth.position.z = Math.random() * 1600 - 800;
        // earth.updateMatrix();
        // earth.matrixAutoUpdate = false;
        // scene.add(earth);

        // // console.log("SCENE: ", scene);

        // function animate() {
        //     requestAnimationFrame(animate);

        //     renderer.render(scene, camera);

        // }

        // function textureLoader(url) {
        //     return new THREE.TextureLoader.load(url);
        // }

        // window.addEventListener('resize', () => {
        //     const width = window.innerWidth;
        //     const height = window.innerHeight;
        //     renderer.setSize(width, height);
        //     camera.aspect = width / height;
        //     camera.updateProjectionMatrix();
        // });
        // animate();
        // renderer.setAnimationLoop(animate);

    </script>
</body>

</html>